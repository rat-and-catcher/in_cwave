/*
 *      CWAVE (RWAVE==WAV) input plugin / quad modulator for WinAmp (XMPlay) player
 *
 *      hblpf.h -- all about Half Band Low Pass Elliptic Filters
 *
 * Copyright (c) 2010-2023, Rat and Catcher Technologies
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *    * Redistributions of source code must retain the above copyright
 *      notice, this list of conditions and the following disclaimer.
 *    * Redistributions in binary form must reproduce the above copyright
 *      notice, this list of conditions and the following disclaimer in the
 *      documentation and/or other materials provided with the distribution.
 *    * Neither the name of the Rat and Catcher Technologies nor the
 *      names of its contributors may be used to endorse or promote products
 *      derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL RAT AND CATCHER TECHNOLOGIES BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#include <stdlib.h>

#include "cmalloc.h"        // BOOL type here
#include "hblpf.h"

/* THE PRECALCULATED elliptic Half Band Low Pass Filterss
 * --- ------------- -------- ---- ---- --- ---- --------
 * in_cwave V02.03.01 statement
 * -------- --------- ---------
 * The precalulated filters, presented below, created by program gen-iir,
 * (github.com/rat-and-catcher/gen-iir), which uses the DSPL-2 library by
 * Serge Bakhurin, www.dsplib.org).
 *
 * Old statement
 * --- ---------
 * this filters was calculated by climed prototypes (designs) using third party tool - DSP.DLL,
 * obtained from the site dsplib.ru, where it's lived some time (w/o sources, only API +
 * win32 binary) and was available fo free. DSP.DLL was written by Serge Bakhurin, dsplib.ru.
 * Unfortunally, now this binary unavailable - it was removed from the site by author as "unsupported".
 * But the site still alive, and even has an English version at dsplib.org. We take many great
 * ideas from Serge Bahurin's site materials, especially from his papers -- many thanks for him
 * from Rat and Catcher Technologies.
 *
 * NOTE: we can't get stable elliptic filters of order greater 19 (now-20!) for our needs (whith
 * extremly small transition width + high rejection (>100dB) and acceptable ripple
 * in pass band. May be latter...
 */

// FP_MIXED -- floating point model, with allow 80-bit intermediate results, versus only 64-bit FP
// arithmetics. This related to computing coefficients of the filters. Some indirect measurement
// tell to us, that FP_MIXED slightly better, that computed strictly, but we unsure. All the
// way we have used strictly model in DSLLIB dll, and this was rather sufficient.
// To signifitantly (??) improve the coefficients we need to increase precision of their
// computation radically, but this is a big challenge for us now.
// So, FP_MIXED coefficient added to mark a point, that there is some precision problem
// in filter computation.

// #define FP_MIXED

#if !defined(FP_MIXED)
// ** Strictly 64-bit-computated coefficients **

// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 15 (16 coefficients in numerator / denominator);
// -- Suppression in stop band 100.0000 dB;
// -- Max. ripple in pass band 1.5000 dB;
// -- Cutoff frequency: 0.495 ([0..1] norm.)
// -- Transition width 0.0099170047 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[16]):
static const uint64_t IIR_LOEL_TYPE0_B[] =              // 16 coefficients
  {
    0x3F619AFC9A02BA05U,  // [ 0] dec:  2.14909874201585580E-003; hex:   0X1.19AFC9A02BA050P-9
    0x3F82AF1B1480D3D4U,  // [ 1] dec:  9.12305027314089940E-003; hex:   0X1.2AF1B1480D3D40P-7
    0x3F9E619E38C69849U,  // [ 2] dec:  2.96692583230185080E-002; hex:   0X1.E619E38C698490P-6
    0x3FB16FC2A89F7068U,  // [ 3] dec:  6.81115781475810640E-002; hex:   0X1.16FC2A89F70680P-4
    0x3FC0957CE6EB0C56U,  // [ 4] dec:  1.29562008622175540E-001; hex:   0X1.0957CE6EB0C560P-3
    0x3FC9FFC923AB0CA9U,  // [ 5] dec:  2.03118460098356910E-001; hex:   0X1.9FFC923AB0CA90P-3
    0x3FD17881D051D3ADU,  // [ 6] dec:  2.72980168759484000E-001; hex:   0X1.17881D051D3AD0P-2
    0x3FD42A1437ED7200U,  // [ 7] dec:  3.15068297020644650E-001; hex:   0X1.42A1437ED72000P-2
    0x3FD42A1437ED7200U,  // [ 8] dec:  3.15068297020644650E-001; hex:   0X1.42A1437ED72000P-2
    0x3FD17881D051D3ADU,  // [ 9] dec:  2.72980168759484000E-001; hex:   0X1.17881D051D3AD0P-2
    0x3FC9FFC923AB0CA9U,  // [10] dec:  2.03118460098356910E-001; hex:   0X1.9FFC923AB0CA90P-3
    0x3FC0957CE6EB0C56U,  // [11] dec:  1.29562008622175540E-001; hex:   0X1.0957CE6EB0C560P-3
    0x3FB16FC2A89F7068U,  // [12] dec:  6.81115781475810640E-002; hex:   0X1.16FC2A89F70680P-4
    0x3F9E619E38C69849U,  // [13] dec:  2.96692583230185080E-002; hex:   0X1.E619E38C698490P-6
    0x3F82AF1B1480D3D4U,  // [14] dec:  9.12305027314089940E-003; hex:   0X1.2AF1B1480D3D40P-7
    0x3F619AFC9A02BA05U   // [15] dec:  2.14909874201585580E-003; hex:   0X1.19AFC9A02BA050P-9
  };
// Denominator coefficients (A[16]):
static const uint64_t IIR_LOEL_TYPE0_A[] =              // 16 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:  1.00000000000000000E+000; hex:   0X1.00000000000000P+0
    0xC00BBE1E2A7C11A7U,  // [ 1] dec: -3.46783097449425130E+000; hex:  -0X1.BBE1E2A7C11A70P+1
    0x4025A35A322FB995U,  // [ 2] dec:  1.08190475161798450E+001; hex:   0X1.5A35A322FB9950P+3
    0xC0367621811D2F5AU,  // [ 3] dec: -2.24614487358333930E+001; hex:  -0X1.67621811D2F5A0P+4
    0x4044411BAB3D802BU,  // [ 4] dec:  4.05086568880363630E+001; hex:   0X1.4411BAB3D802B0P+5
    0xC04D84F808E4DB7FU,  // [ 5] dec: -5.90388194196193510E+001; hex:  -0X1.D84F808E4DB7F0P+5
    0x4052C36C169DAE7BU,  // [ 6] dec:  7.50534721889361410E+001; hex:   0X1.2C36C169DAE7B0P+6
    0xC05452666489F59DU,  // [ 7] dec: -8.12874995562801390E+001; hex:  -0X1.452666489F59D0P+6
    0x405333CC1E26D46DU,  // [ 8] dec:  7.68093333605954310E+001; hex:   0X1.333CC1E26D46D0P+6
    0xC04F45FACA091E73U,  // [ 9] dec: -6.25467159790540780E+001; hex:  -0X1.F45FACA091E730P+5
    0x4045F225DA5BF82DU,  // [10] dec:  4.38917801808423530E+001; hex:   0X1.5F225DA5BF82D0P+5
    0xC03A2E9885BDCC38U,  // [11] dec: -2.61820148075459830E+001; hex:  -0X1.A2E9885BDCC380P+4
    0x4029E121FF4841FDU,  // [12] dec:  1.29397125030236510E+001; hex:   0X1.9E121FF4841FD0P+3
    0xC014B2BF6CC051ACU,  // [13] dec: -5.17455835269758420E+000; hex:  -0X1.4B2BF6CC051AC0P+2
    0x3FF7E50A33B0A073U,  // [14] dec:  1.49341793242822680E+000; hex:   0X1.7E50A33B0A0730P+0
    0xBFD30189DD3C9C54U   // [15] dec: -2.96968904544376190E-001; hex:  -0X1.30189DD3C9C540P-2
  };

// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 19 (20 coefficients in numerator / denominator);
// -- Suppression in stop band 100.0000 dB;
// -- Max. ripple in pass band 1.8000 dB;
// -- Cutoff frequency: 0.499 ([0..1] norm.)
// -- Transition width 0.002131305 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[20]):
static const uint64_t IIR_LOEL_TYPE1_B[] =              // 20 coefficients
  {
    0x3F61616AB173668BU,  // [ 0] dec:  2.12164724835590050E-003; hex:   0X1.1616AB173668B0P-9
    0x3F825102375E9B13U,  // [ 1] dec:  8.94357425188511100E-003; hex:   0X1.25102375E9B130P-7
    0x3FA10E931F1BEAB5U,  // [ 2] dec:  3.33143210863985700E-002; hex:   0X1.10E931F1BEAB50P-5
    0x3FB5A04D2843C950U,  // [ 3] dec:  8.44772551825248020E-002; hex:   0X1.5A04D2843C9500P-4
    0x3FC7EB1F823D4892U,  // [ 4] dec:  1.86862886994792420E-001; hex:   0X1.7EB1F823D48920P-3
    0x3FD5C96C08823278U,  // [ 5] dec:  3.40418823537028010E-001; hex:   0X1.5C96C088232780P-2
    0x3FE18EDE760081FDU,  // [ 6] dec:  5.48690062019943190E-001; hex:   0X1.18EDE760081FD0P-1
    0x3FE8A8C0817B920CU,  // [ 7] dec:  7.70599606414692940E-001; hex:   0X1.8A8C0817B920C0P-1
    0x3FEEF08441994DDDU,  // [ 8] dec:  9.66859939692252040E-001; hex:   0X1.EF08441994DDD0P-1
    0x3FF145DAFF26CB16U,  // [ 9] dec:  1.07955455463951950E+000; hex:   0X1.145DAFF26CB160P+0
    0x3FF145DAFF26CB16U,  // [10] dec:  1.07955455463951950E+000; hex:   0X1.145DAFF26CB160P+0
    0x3FEEF08441994DDDU,  // [11] dec:  9.66859939692252040E-001; hex:   0X1.EF08441994DDD0P-1
    0x3FE8A8C0817B920CU,  // [12] dec:  7.70599606414692940E-001; hex:   0X1.8A8C0817B920C0P-1
    0x3FE18EDE760081FDU,  // [13] dec:  5.48690062019943190E-001; hex:   0X1.18EDE760081FD0P-1
    0x3FD5C96C08823278U,  // [14] dec:  3.40418823537028010E-001; hex:   0X1.5C96C088232780P-2
    0x3FC7EB1F823D4892U,  // [15] dec:  1.86862886994792420E-001; hex:   0X1.7EB1F823D48920P-3
    0x3FB5A04D2843C950U,  // [16] dec:  8.44772551825248020E-002; hex:   0X1.5A04D2843C9500P-4
    0x3FA10E931F1BEAB5U,  // [17] dec:  3.33143210863985700E-002; hex:   0X1.10E931F1BEAB50P-5
    0x3F825102375E9B13U,  // [18] dec:  8.94357425188511100E-003; hex:   0X1.25102375E9B130P-7
    0x3F61616AB173668BU   // [19] dec:  2.12164724835590050E-003; hex:   0X1.1616AB173668B0P-9
  };
// Denominator coefficients (A[20]):
static const uint64_t IIR_LOEL_TYPE1_A[] =              // 20 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:  1.00000000000000000E+000; hex:   0X1.00000000000000P+0
    0xC00BE310CADB1EDCU,  // [ 1] dec: -3.48587187272265280E+000; hex:  -0X1.BE310CADB1EDC0P+1
    0x4029CB562280899EU,  // [ 2] dec:  1.28971415311723910E+001; hex:   0X1.9CB562280899E0P+3
    0xC03DAD9F07D88A8FU,  // [ 3] dec: -2.96782078651108880E+001; hex:  -0X1.DAD9F07D88A8F0P+4
    0x404FED34774B7273U,  // [ 4] dec:  6.38531636351007350E+001; hex:   0X1.FED34774B72730P+5
    0xC05B3C73E21E9301U,  // [ 5] dec: -1.08944572954042100E+002; hex:  -0X1.B3C73E21E93010P+6
    0x406532CAC3A7048FU,  // [ 6] dec:  1.69587251497465760E+002; hex:   0X1.532CAC3A7048F0P+7
    0xC06C4112B1B044ECU,  // [ 7] dec: -2.26033531994129020E+002; hex:  -0X1.C4112B1B044EC0P+7
    0x40711247B1FD71EDU,  // [ 8] dec:  2.73142503728885290E+002; hex:   0X1.11247B1FD71ED0P+8
    0xC07231202413D0B8U,  // [ 9] dec: -2.91070346906093160E+002; hex:  -0X1.231202413D0B80P+8
    0x40717F31DAC223FEU,  // [10] dec:  2.79949671514856050E+002; hex:   0X1.17F31DAC223FE0P+8
    0xC06DF42A52AB6021U,  // [11] dec: -2.39630166372983720E+002; hex:  -0X1.DF42A52AB60210P+7
    0x4066EFE838B0EFB9U,  // [12] dec:  1.83497097344950620E+002; hex:   0X1.6EFE838B0EFB90P+7
    0xC05F261632432921U,  // [13] dec: -1.24595104756914690E+002; hex:  -0X1.F2616324329210P+6
    0x40528D2F7C13B07EU,  // [14] dec:  7.42060232345847620E+001; hex:   0X1.28D2F7C13B07E0P+6
    0xC043456DD83FFF9DU,  // [15] dec: -3.85424146950237870E+001; hex:  -0X1.3456DD83FFF9D0P+5
    0x4030BC445544A337U,  // [16] dec:  1.67354176800319830E+001; hex:   0X1.0BC445544A3370P+4
    0xC0187118078E2617U,  // [17] dec: -6.11044322781665180E+000; hex:  -0X1.87118078E26170P+2
    0x3FF968D5E4E055D0U,  // [18] dec:  1.58809461026008950E+000; hex:   0X1.968D5E4E055D00P+0
    0xBFD49BF4B34C446EU   // [19] dec: -3.22018790336250470E-001; hex:  -0X1.49BF4B34C446E0P-2
  };

// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 18 (19 coefficients in numerator / denominator);
// -- Suppression in stop band 90.0000 dB;
// -- Max. ripple in pass band 2.0000 dB;
// -- Cutoff frequency: 0.499 ([0..1] norm.)
// -- Transition width 0.0015685821 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[19]):
static const uint64_t IIR_LOEL_TYPE2_B[] =              // 19 coefficients
  {
    0x3F6E9A7EF6B7FF9BU,  // [ 0] dec:  3.73577878576720820E-003; hex:   0X1.E9A7EF6B7FF9B0P-9
    0x3F8D2E91CD23A859U,  // [ 1] dec:  1.42489805916349730E-002; hex:   0X1.D2E91CD23A8590P-7
    0x3FAA79F8E2F72579U,  // [ 2] dec:  5.17118241364852920E-002; hex:   0X1.A79F8E2F725790P-5
    0x3FBF96D75511111CU,  // [ 3] dec:  1.23395403164128610E-001; hex:   0X1.F96D75511111C0P-4
    0x3FD0D878B78448EDU,  // [ 4] dec:  2.63212374892772880E-001; hex:   0X1.0D878B78448ED0P-2
    0x3FDD287406E7F1EBU,  // [ 5] dec:  4.55594069236922190E-001; hex:   0X1.D287406E7F1EB0P-2
    0x3FE688A02DE3322CU,  // [ 6] dec:  7.04177941917412560E-001; hex:   0X1.688A02DE3322C0P-1
    0x3FEE12DA8CB080AEU,  // [ 7] dec:  9.39801478180035010E-001; hex:   0X1.E12DA8CB080AE0P-1
    0x3FF1FF5095FF5225U,  // [ 8] dec:  1.12483271210397470E+000; hex:   0X1.1FF5095FF52250P+0
    0x3FF2FCC12CAA3DBCU,  // [ 9] dec:  1.18670766303317430E+000; hex:   0X1.2FCC12CAA3DBC0P+0
    0x3FF1FF5095FF5225U,  // [10] dec:  1.12483271210397470E+000; hex:   0X1.1FF5095FF52250P+0
    0x3FEE12DA8CB080AEU,  // [11] dec:  9.39801478180035010E-001; hex:   0X1.E12DA8CB080AE0P-1
    0x3FE688A02DE3322CU,  // [12] dec:  7.04177941917412560E-001; hex:   0X1.688A02DE3322C0P-1
    0x3FDD287406E7F1EBU,  // [13] dec:  4.55594069236922190E-001; hex:   0X1.D287406E7F1EB0P-2
    0x3FD0D878B78448EDU,  // [14] dec:  2.63212374892772880E-001; hex:   0X1.0D878B78448ED0P-2
    0x3FBF96D75511111CU,  // [15] dec:  1.23395403164128610E-001; hex:   0X1.F96D75511111C0P-4
    0x3FAA79F8E2F72579U,  // [16] dec:  5.17118241364852920E-002; hex:   0X1.A79F8E2F725790P-5
    0x3F8D2E91CD23A859U,  // [17] dec:  1.42489805916349730E-002; hex:   0X1.D2E91CD23A8590P-7
    0x3F6E9A7EF6B7FF9BU   // [18] dec:  3.73577878576720820E-003; hex:   0X1.E9A7EF6B7FF9B0P-9
  };
// Denominator coefficients (A[19]):
static const uint64_t IIR_LOEL_TYPE2_A[] =              // 19 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:  1.00000000000000000E+000; hex:   0X1.00000000000000P+0
    0xC0092AC40137416AU,  // [ 1] dec: -3.14588166189075920E+000; hex:  -0X1.92AC40137416A0P+1
    0x4027069435724C96U,  // [ 2] dec:  1.15128494932198850E+001; hex:   0X1.7069435724C960P+3
    0xC038C950A3E8D905U,  // [ 3] dec: -2.47863867228961860E+001; hex:  -0X1.8C950A3E8D9050P+4
    0x4049F5E6E468F2DAU,  // [ 4] dec:  5.19211087715572860E+001; hex:   0X1.9F5E6E468F2DA0P+5
    0xC054F78F96DC2BDCU,  // [ 5] dec: -8.38681389951811410E+001; hex:  -0X1.4F78F96DC2BDC0P+6
    0x405F784A718D036FU,  // [ 6] dec:  1.25879543674190910E+002; hex:   0X1.F784A718D036F0P+6
    0xC063E5A30D375A29U,  // [ 7] dec: -1.59176153762922040E+002; hex:  -0X1.3E5A30D375A290P+7
    0x4066FD0682B38D64U,  // [ 8] dec:  1.83907044745147800E+002; hex:   0X1.6FD0682B38D640P+7
    0xC06725D13A955B7AU,  // [ 9] dec: -1.85181790630067380E+002; hex:  -0X1.725D13A955B7A0P+7
    0x4065149F4F65FBA6U,  // [10] dec:  1.68644447039781140E+002; hex:   0X1.5149F4F65FBA60P+7
    0xC060DF1ECDAC6007U,  // [11] dec: -1.34972510182066090E+002; hex:  -0X1.0DF1ECDAC60070P+7
    0x4058250DE3176D79U,  // [12] dec:  9.65789725998673840E+001; hex:   0X1.8250DE3176D790P+6
    0xC04DFF728CAC97FBU,  // [13] dec: -5.99956832735769790E+001; hex:  -0X1.DFF728CAC97FB0P+5
    0x40405D935F6F80C6U,  // [14] dec:  3.27310599607895230E+001; hex:   0X1.05D935F6F80C60P+5
    0xC02D9533B6F792BFU,  // [15] dec: -1.47914101769650850E+001; hex:  -0X1.D9533B6F792BF0P+3
    0x4016CCDD51142D93U,  // [16] dec:  5.70006300626427540E+000; hex:   0X1.6CCDD51142D930P+2
    0xBFF88F38CE4768E9U,  // [17] dec: -1.53496628358566970E+000; hex:  -0X1.88F38CE4768E90P+0
    0x3FD5B6E90480857FU   // [18] dec:  3.39288954159279340E-001; hex:   0X1.5B6E90480857F0P-2
  };

// !!THE UGLY FILTER -- NOT FOR CONVENTIONAL USE -- ONLY FOR EXPERIMENTS --
// -- THE GUY IS ABOUT GENERATION NEAR CUTOFF FREUENCY!!
// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 19 (20 coefficients in numerator / denominator);
// -- Suppression in stop band 96.0000 dB;
// -- Max. ripple in pass band 2.0000 dB;
// -- Cutoff frequency: 0.4982 ([0..1] norm.)
// -- Transition width 0.0015899102 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[20]):
static const uint64_t IIR_LOEL_TYPE3_B[] =              // 20 coefficients
  {
    0x3F6576F5632D5F44U,  // [ 0] dec:  2.62020041683888770E-003; hex:   0X1.576F5632D5F440P-9
    0x3F856D2EC232921DU,  // [ 1] dec:  1.04621556295763590E-002; hex:   0X1.56D2EC232921D0P-7
    0x3FA400328D1571C7U,  // [ 2] dec:  3.90640065404315660E-002; hex:   0X1.400328D1571C70P-5
    0x3FB8D24D69D7027DU,  // [ 3] dec:  9.69589599035404900E-002; hex:   0X1.8D24D69D7027D0P-4
    0x3FCB65B7E3A59ADCU,  // [ 4] dec:  2.14041696696958610E-001; hex:   0X1.B65B7E3A59ADC0P-3
    0x3FD8B2ED62D87921U,  // [ 5] dec:  3.85920855072884150E-001; hex:   0X1.8B2ED62D879210P-2
    0x3FE3DC4495952C66U,  // [ 6] dec:  6.20638172296264610E-001; hex:   0X1.3DC4495952C660P-1
    0x3FEBC12160D83B5AU,  // [ 7] dec:  8.67325486325948750E-001; hex:   0X1.BC12160D83B5A0P-1
    0x3FF1639B9928E633U,  // [ 8] dec:  1.08681831195862060E+000; hex:   0X1.1639B9928E6330P+0
    0x3FF3630A01EAF8A6U,  // [ 9] dec:  1.21167946576273660E+000; hex:   0X1.3630A01EAF8A60P+0
    0x3FF3630A01EAF8A6U,  // [10] dec:  1.21167946576273660E+000; hex:   0X1.3630A01EAF8A60P+0
    0x3FF1639B9928E633U,  // [11] dec:  1.08681831195862060E+000; hex:   0X1.1639B9928E6330P+0
    0x3FEBC12160D83B5AU,  // [12] dec:  8.67325486325948750E-001; hex:   0X1.BC12160D83B5A0P-1
    0x3FE3DC4495952C66U,  // [13] dec:  6.20638172296264610E-001; hex:   0X1.3DC4495952C660P-1
    0x3FD8B2ED62D87921U,  // [14] dec:  3.85920855072884150E-001; hex:   0X1.8B2ED62D879210P-2
    0x3FCB65B7E3A59ADCU,  // [15] dec:  2.14041696696958610E-001; hex:   0X1.B65B7E3A59ADC0P-3
    0x3FB8D24D69D7027DU,  // [16] dec:  9.69589599035404900E-002; hex:   0X1.8D24D69D7027D0P-4
    0x3FA400328D1571C7U,  // [17] dec:  3.90640065404315660E-002; hex:   0X1.400328D1571C70P-5
    0x3F856D2EC232921DU,  // [18] dec:  1.04621556295763590E-002; hex:   0X1.56D2EC232921D0P-7
    0x3F6576F5632D5F44U   // [19] dec:  2.62020041683888770E-003; hex:   0X1.576F5632D5F440P-9
  };
// Denominator coefficients (A[20]):
static const uint64_t IIR_LOEL_TYPE3_A[] =              // 20 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:  1.00000000000000000E+000; hex:   0X1.00000000000000P+0
    0xC00B41B2DE950929U,  // [ 1] dec: -3.40707944767304530E+000; hex:  -0X1.B41B2DE9509290P+1
    0x402970A0EA172D03U,  // [ 2] dec:  1.27199776795664600E+001; hex:   0X1.970A0EA172D030P+3
    0xC03CFED84AB0ED47U,  // [ 3] dec: -2.89954878503752090E+001; hex:  -0X1.CFED84AB0ED470P+4
    0x404F590317F3C410U,  // [ 4] dec:  6.26954069080603630E+001; hex:   0X1.F590317F3C4100P+5
    0xC05AA35640A0E00EU,  // [ 5] dec: -1.06552139432053280E+002; hex:  -0X1.AA35640A0E00E0P+6
    0x4064CDC8BD4B0A49U,  // [ 6] dec:  1.66430754324496120E+002; hex:   0X1.4CDC8BD4B0A490P+7
    0xC06BB310D9003B3DU,  // [ 7] dec: -2.21595806599094350E+002; hex:  -0X1.BB310D9003B3D0P+7
    0x4070C8F6C4CDF4A4U,  // [ 8] dec:  2.68560246281160520E+002; hex:   0X1.0C8F6C4CDF4A40P+8
    0xC071E67A4835A0F8U,  // [ 9] dec: -2.86404854020583570E+002; hex:  -0X1.1E67A4835A0F80P+8
    0x407144517F3D71B7U,  // [10] dec:  2.76269896736160660E+002; hex:   0X1.144517F3D71B70P+8
    0xC06D9FEC7452436AU,  // [11] dec: -2.36997614060087760E+002; hex:  -0X1.D9FEC7452436A0P+7
    0x4066C2447072BF85U,  // [12] dec:  1.82070854400746750E+002; hex:   0X1.6C2447072BF850P+7
    0xC05F058A09B24BB4U,  // [13] dec: -1.24086550163380540E+002; hex:  -0X1.F058A09B24BB40P+6
    0x40528B6CE7AB88B9U,  // [14] dec:  7.41785220313203270E+001; hex:   0X1.28B6CE7AB88B90P+6
    0xC043617A896818BFU,  // [15] dec: -3.87615520246777050E+001; hex:  -0X1.3617A896818BF0P+5
    0x4030E63ADAFAABE6U,  // [16] dec:  1.68993355619421880E+001; hex:   0X1.0E63ADAFAABE60P+4
    0xC018F5717FC5675BU,  // [17] dec: -6.23969077722889680E+000; hex:  -0X1.8F5717FC5675B0P+2
    0x3FFA06EE9694BC96U,  // [18] dec:  1.62669237919525280E+000; hex:   0X1.A06EE9694BC960P+0
    0xBFD5C02814FC1467U   // [19] dec: -3.39853306286676150E-001; hex:  -0X1.5C02814FC14670P-2
  };

// !!THE UGLY FILTER -- NOT FOR CONVENTIONAL USE -- ONLY FOR EXPERIMENTS --
// -- THE GUY IS ABOUT GENERATION NEAR CUTOFF FREUENCY!!
// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 20 (21 coefficients in numerator / denominator);
// -- Suppression in stop band 100.0000 dB;
// -- Max. ripple in pass band 2.0000 dB;
// -- Cutoff frequency: 0.4982 ([0..1] norm.)
// -- Transition width 0.001414773 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[21]):
static const uint64_t IIR_LOEL_TYPE4_B[] =              // 21 coefficients
  {
    0x3F6105CC7C5CBC69U,  // [ 0] dec:  2.07796038275591790E-003; hex:   0X1.105CC7C5CBC690P-9
    0x3F81955643AB4B9DU,  // [ 1] dec:  8.58561891565106680E-003; hex:   0X1.1955643AB4B9D0P-7
    0x3FA0E59FD9ABE75AU,  // [ 2] dec:  3.30018952572134900E-002; hex:   0X1.0E59FD9ABE75A0P-5
    0x3FB5AE5A762E5FB7U,  // [ 3] dec:  8.46916712310975400E-002; hex:   0X1.5AE5A762E5FB70P-4
    0x3FC8BDB6858FC0F8U,  // [ 4] dec:  1.93289580550761060E-001; hex:   0X1.8BDB6858FC0F80P-3
    0x3FD71EFDB4D343E6U,  // [ 5] dec:  3.61266542994654550E-001; hex:   0X1.71EFDB4D343E60P-2
    0x3FE350C40F25D47BU,  // [ 6] dec:  6.03609113297934540E-001; hex:   0X1.350C40F25D47B0P-1
    0x3FEC1A5CD098A437U,  // [ 7] dec:  8.78218085684358550E-001; hex:   0X1.C1A5CD098A4370P-1
    0x3FF26A2239023446U,  // [ 8] dec:  1.15091154355038010E+000; hex:   0X1.26A22390234460P+0
    0x3FF5809599CEFF59U,  // [ 9] dec:  1.34389267045476960E+000; hex:   0X1.5809599CEFF590P+0
    0x3FF6B599D324228FU,  // [10] dec:  1.41933615185749650E+000; hex:   0X1.6B599D324228F0P+0
    0x3FF5809599CEFF59U,  // [11] dec:  1.34389267045476960E+000; hex:   0X1.5809599CEFF590P+0
    0x3FF26A2239023446U,  // [12] dec:  1.15091154355038010E+000; hex:   0X1.26A22390234460P+0
    0x3FEC1A5CD098A437U,  // [13] dec:  8.78218085684358550E-001; hex:   0X1.C1A5CD098A4370P-1
    0x3FE350C40F25D47BU,  // [14] dec:  6.03609113297934540E-001; hex:   0X1.350C40F25D47B0P-1
    0x3FD71EFDB4D343E6U,  // [15] dec:  3.61266542994654550E-001; hex:   0X1.71EFDB4D343E60P-2
    0x3FC8BDB6858FC0F8U,  // [16] dec:  1.93289580550761060E-001; hex:   0X1.8BDB6858FC0F80P-3
    0x3FB5AE5A762E5FB7U,  // [17] dec:  8.46916712310975400E-002; hex:   0X1.5AE5A762E5FB70P-4
    0x3FA0E59FD9ABE75AU,  // [18] dec:  3.30018952572134900E-002; hex:   0X1.0E59FD9ABE75A0P-5
    0x3F81955643AB4B9DU,  // [19] dec:  8.58561891565106680E-003; hex:   0X1.1955643AB4B9D0P-7
    0x3F6105CC7C5CBC69U   // [20] dec:  2.07796038275591790E-003; hex:   0X1.105CC7C5CBC690P-9
  };
// Denominator coefficients (A[21]):
static const uint64_t IIR_LOEL_TYPE4_A[] =          // 21 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:  1.00000000000000000E+000; hex:   0X1.00000000000000P+0
    0xC00C7D82D1B03B10U,  // [ 1] dec: -3.56128467387259920E+000; hex:  -0X1.C7D82D1B03B100P+1
    0x402B532367BD1433U,  // [ 2] dec:  1.36623794954594810E+001; hex:   0X1.B532367BD14330P+3
    0xC0403152BB93B333U,  // [ 3] dec: -3.23853373023215670E+001; hex:  -0X1.03152BB93B3330P+5
    0x40521900A7EFCE19U,  // [ 4] dec:  7.23906650392385840E+001; hex:   0X1.21900A7EFCE190P+6
    0xC0600131C59BF008U,  // [ 5] dec: -1.28037325672689120E+002; hex:  -0X1.00131C59BF0080P+7
    0x4069FD3A9FD5A9DEU,  // [ 6] dec:  2.07913406293212520E+002; hex:   0X1.9FD3A9FD5A9DE0P+7
    0xC07212F5FE6A199CU,  // [ 7] dec: -2.89185057081654800E+002; hex:  -0X1.212F5FE6A199C0P+8
    0x4076ED28243B6725U,  // [ 8] dec:  3.66822300178568470E+002; hex:   0X1.6ED28243B67250P+8
    0xC079B4038C1A4996U,  // [ 9] dec: -4.11250866034207660E+002; hex:  -0X1.9B4038C1A49960P+8
    0x407A30F362603582U,  // [10] dec:  4.19059419990364520E+002; hex:   0X1.A30F3626035820P+8
    0xC077D86046C38B7FU,  // [11] dec: -3.81523504985663690E+002; hex:  -0X1.7D86046C38B7F0P+8
    0x4073A0AD10AEDD99U,  // [12] dec:  3.14042252238339240E+002; hex:   0X1.3A0AD10AEDD990P+8
    0xC06CCD2771406576U,  // [13] dec: -2.30411064744733890E+002; hex:  -0X1.CCD27714065760P+7
    0x4062E94268741CDCU,  // [14] dec:  1.51289356447966270E+002; hex:   0X1.2E94268741CDC0P+7
    0xC055C1A3C0241523U,  // [15] dec: -8.70256195404404450E+001; hex:  -0X1.5C1A3C02415230P+6
    0x4045FB3DD7A2C3B9U,  // [16] dec:  4.39628247780560240E+001; hex:   0X1.5FB3DD7A2C3B90P+5
    0xC03289B60654179EU,  // [17] dec: -1.85379337268164970E+001; hex:  -0X1.289B60654179E0P+4
    0x401A888D2AA55875U,  // [18] dec:  6.63335100778760010E+000; hex:   0X1.A888D2AA558750P+2
    0xBFFADD00E7E16D4AU,  // [19] dec: -1.67895594194745220E+000; hex:  -0X1.ADD00E7E16D4A0P+0
    0x3FD5C0724C400EABU   // [20] dec:  3.39871000731572340E-001; hex:   0X1.5C0724C400EAB0P-2
  };

// !!THE UGLY FILTER -- NOT FOR CONVENTIONAL USE -- ONLY FOR EXPERIMENTS --
// -- THE GUY IS ABOUT GENERATION NEAR CUTOFF FREUENCY!!
// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 20 (21 coefficients in numerator / denominator);
// -- Suppression in stop band 100.0000 dB;
// -- Max. ripple in pass band 2.0000 dB;
// -- Cutoff frequency: 0.4985 ([0..1] norm.)
// -- Transition width 0.001414773 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[21]):
static const uint64_t IIR_LOEL_TYPE5_B[] =          // 21 coefficients
  {
    0x3F6115A0362A0507U,  // [ 0] dec:  2.08550731014212370E-003; hex:   0X1.115A0362A05070P-9
    0x3F81B78F1BF99472U,  // [ 1] dec:  8.65089229700741550E-003; hex:   0X1.1B78F1BF994720P-7
    0x3FA106C68AA3F2F5U,  // [ 2] dec:  3.32548183668900720E-002; hex:   0X1.106C68AA3F2F50P-5
    0x3FB5E2194F93B441U,  // [ 3] dec:  8.54812449722013450E-002; hex:   0X1.5E2194F93B4410P-4
    0x3FC8FABE73E9B77BU,  // [ 4] dec:  1.95152098272440930E-001; hex:   0X1.8FABE73E9B77B0P-3
    0x3FD75D0F146BEAC6U,  // [ 5] dec:  3.65054864828988080E-001; hex:   0X1.75D0F146BEAC60P-2
    0x3FE385FBE5F6244BU,  // [ 6] dec:  6.10105466025865240E-001; hex:   0X1.385FBE5F6244B0P-1
    0x3FEC6B051C1551CCU,  // [ 7] dec:  8.88063959932475110E-001; hex:   0X1.C6B051C1551CC0P-1
    0x3FF29FB67CC742FDU,  // [ 8] dec:  1.16399239293622190E+000; hex:   0X1.29FB67CC742FD0P+0
    0x3FF5C037D3726560U,  // [ 9] dec:  1.35942823978833620E+000; hex:   0X1.5C037D37265600P+0
    0x3FF6F8C9E81EBA61U,  // [10] dec:  1.43573942825209880E+000; hex:   0X1.6F8C9E81EBA610P+0
    0x3FF5C037D3726560U,  // [11] dec:  1.35942823978833620E+000; hex:   0X1.5C037D37265600P+0
    0x3FF29FB67CC742FDU,  // [12] dec:  1.16399239293622190E+000; hex:   0X1.29FB67CC742FD0P+0
    0x3FEC6B051C1551CCU,  // [13] dec:  8.88063959932475110E-001; hex:   0X1.C6B051C1551CC0P-1
    0x3FE385FBE5F6244BU,  // [14] dec:  6.10105466025865240E-001; hex:   0X1.385FBE5F6244B0P-1
    0x3FD75D0F146BEAC6U,  // [15] dec:  3.65054864828988080E-001; hex:   0X1.75D0F146BEAC60P-2
    0x3FC8FABE73E9B77BU,  // [16] dec:  1.95152098272440930E-001; hex:   0X1.8FABE73E9B77B0P-3
    0x3FB5E2194F93B441U,  // [17] dec:  8.54812449722013450E-002; hex:   0X1.5E2194F93B4410P-4
    0x3FA106C68AA3F2F5U,  // [18] dec:  3.32548183668900720E-002; hex:   0X1.106C68AA3F2F50P-5
    0x3F81B78F1BF99472U,  // [19] dec:  8.65089229700741550E-003; hex:   0X1.1B78F1BF994720P-7
    0x3F6115A0362A0507U   // [20] dec:  2.08550731014212370E-003; hex:   0X1.115A0362A05070P-9
  };
// Denominator coefficients (A[21]):
static const uint64_t IIR_LOEL_TYPE5_A[] =          // 21 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:  1.00000000000000000E+000; hex:   0X1.00000000000000P+0
    0xC00C5C130ACD4DE0U,  // [ 1] dec: -3.54495819510496800E+000; hex:  -0X1.C5C130ACD4DE00P+1
    0x402B372B4460A8BDU,  // [ 2] dec:  1.36077519767753700E+001; hex:   0X1.B372B4460A8BD0P+3
    0xC04018067D5C7BDDU,  // [ 3] dec: -3.21876980496960880E+001; hex:  -0X1.018067D5C7BDD0P+5
    0x4051FCF1B08ABAFBU,  // [ 4] dec:  7.19522515635289180E+001; hex:   0X1.1FCF1B08ABAFB0P+6
    0xC05FC7BF1760A08BU,  // [ 5] dec: -1.27121038288462090E+002; hex:  -0X1.FC7BF1760A08B0P+6
    0x4069CD106F19F99FU,  // [ 6] dec:  2.06408256102306920E+002; hex:   0X1.9CD106F19F99F0P+7
    0xC071EEC5687BAA7CU,  // [ 7] dec: -2.86923195345945490E+002; hex:  -0X1.1EEC5687BAA7C0P+8
    0x4076BEEACC80026FU,  // [ 8] dec:  3.63932323932683120E+002; hex:   0X1.6BEEACC80026F0P+8
    0xC0797E7581F3DFBEU,  // [ 9] dec: -4.07903688385613240E+002; hex:  -0X1.97E7581F3DFBE0P+8
    0x4079FAA5C67F698BU,  // [10] dec:  4.15665472505287370E+002; hex:   0X1.9FAA5C67F698B0P+8
    0xC077A6C923C34A3BU,  // [11] dec: -3.78424106371737880E+002; hex:  -0X1.7A6C923C34A3B0P+8
    0x407378C63DFAEC24U,  // [12] dec:  3.11548398952642170E+002; hex:   0X1.378C63DFAEC240P+8
    0xC06C93E512E1F2B0U,  // [13] dec: -2.28621713105492290E+002; hex:  -0X1.C93E512E1F2B00P+7
    0x4062C57E1067F622U,  // [14] dec:  1.50171638682412830E+002; hex:   0X1.2C57E1067F6220P+7
    0xC0559A827DE298E5U,  // [15] dec: -8.64142145836700170E+001; hex:  -0X1.59A827DE298E50P+6
    0x4045D786848EB6D3U,  // [16] dec:  4.36837926575514290E+001; hex:   0X1.5D786848EB6D30P+5
    0xC0326E1D8797A18BU,  // [17] dec: -1.84301380868142070E+001; hex:  -0X1.26E1D8797A18B0P+4
    0x401A69C6F9E351C1U,  // [18] dec:  6.60329809617945870E+000; hex:   0X1.A69C6F9E351C10P+2
    0xBFFAC1D468DFDE2CU,  // [19] dec: -1.67232171026797530E+000; hex:  -0X1.AC1D468DFDE2C0P+0
    0x3FD5BCD46E19EAF1U   // [20] dec:  3.39650256653540930E-001; hex:   0X1.5BCD46E19EAF10P-2
  };

#else                   // def FP_MIXED
// ** The coefficients, calculated with FP_MIXED **

// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 15 (16 coefficients in numerator / denominator);
// -- Suppression in stop band 100.0000 dB;
// -- Max. ripple in pass band 1.5000 dB;
// -- Cutoff frequency: 0.495 ([0..1] norm.)
// -- Transition width 0.0099170047 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[16]):
static const uint64_t IIR_LOEL_TYPE0_B[] =              // 16 coefficients
  {
    0x3F619AFB225AF43EU,  // [ 0] dec:   2.14909600876336728E-03; hex:   0X1.19AFB225AF43E0P-9
    0x3F82AF19D4DFA5A3U,  // [ 1] dec:   9.12304097069488971E-03; hex:   0X1.2AF19D4DFA5A30P-7
    0x3F9E619C4151383DU,  // [ 2] dec:   2.96692290178770419E-02; hex:   0X1.E619C4151383D0P-6
    0x3FB16FC1A08DF283U,  // [ 3] dec:   6.81115166643824627E-02; hex:   0X1.16FC1A08DF2830P-4
    0x3FC0957BF3818DA1U,  // [ 4] dec:   1.29561895274588529E-01; hex:   0X1.0957BF3818DA10P-3
    0x3FC9FFC7B5F1B1C3U,  // [ 5] dec:   2.03118289794828127E-01; hex:   0X1.9FFC7B5F1B1C30P-3
    0x3FD17880DEC92354U,  // [ 6] dec:   2.72979943813472348E-01; hex:   0X1.17880DEC923540P-2
    0x3FD42A1324BC33ECU,  // [ 7] dec:   3.15068040727793486E-01; hex:   0X1.42A1324BC33EC0P-2
    0x3FD42A1324BC33ECU,  // [ 8] dec:   3.15068040727793486E-01; hex:   0X1.42A1324BC33EC0P-2
    0x3FD17880DEC92354U,  // [ 9] dec:   2.72979943813472348E-01; hex:   0X1.17880DEC923540P-2
    0x3FC9FFC7B5F1B1C3U,  // [10] dec:   2.03118289794828127E-01; hex:   0X1.9FFC7B5F1B1C30P-3
    0x3FC0957BF3818DA1U,  // [11] dec:   1.29561895274588529E-01; hex:   0X1.0957BF3818DA10P-3
    0x3FB16FC1A08DF283U,  // [12] dec:   6.81115166643824627E-02; hex:   0X1.16FC1A08DF2830P-4
    0x3F9E619C4151383DU,  // [13] dec:   2.96692290178770419E-02; hex:   0X1.E619C4151383D0P-6
    0x3F82AF19D4DFA5A3U,  // [14] dec:   9.12304097069488971E-03; hex:   0X1.2AF19D4DFA5A30P-7
    0x3F619AFB225AF43EU   // [15] dec:   2.14909600876336728E-03; hex:   0X1.19AFB225AF43E0P-9
  };
// Denominator coefficients (A[16]):
static const uint64_t IIR_LOEL_TYPE0_A[] =              // 16 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:   1.00000000000000000E+00; hex:   0X1.00000000000000P+0
    0xC00BBE1E8097BC6DU,  // [ 1] dec:  -3.46783161604940071E+00; hex:  -0X1.BBE1E8097BC6D0P+1
    0x4025A35A6CE6FD4EU,  // [ 2] dec:   1.08190492660493440E+01; hex:   0X1.5A35A6CE6FD4E0P+3
    0xC0367621D7B6A2A6U,  // [ 3] dec:  -2.24614538975607942E+01; hex:  -0X1.67621D7B6A2A60P+4
    0x4044411BF7A7BC77U,  // [ 4] dec:   4.05086659974121446E+01; hex:   0X1.4411BF7A7BC770P+5
    0xC04D84F8865B6769U,  // [ 5] dec:  -5.90388343759830789E+01; hex:  -0X1.D84F8865B67690P+5
    0x4052C36C65792F02U,  // [ 6] dec:   7.50534909900125342E+01; hex:   0X1.2C36C65792F020P+6
    0xC0545266BD08130AU,  // [ 7] dec:  -8.12875206545687945E+01; hex:  -0X1.45266BD08130A0P+6
    0x405333CC6FC2E8DCU,  // [ 8] dec:   7.68093528178609972E+01; hex:   0X1.333CC6FC2E8DC0P+6
    0xC04F45FB4CC51A2DU,  // [ 9] dec:  -6.25467315637982679E+01; hex:  -0X1.F45FB4CC51A2D0P+5
    0x4045F226318599B9U,  // [10] dec:   4.38917905714365091E+01; hex:   0X1.5F226318599B90P+5
    0xC03A2E98E6078937U,  // [11] dec:  -2.61820205467604090E+01; hex:  -0X1.A2E98E60789370P+4
    0x4029E1225557809DU,  // [12] dec:   1.29397150677980850E+01; hex:   0X1.9E1225557809D0P+3
    0xC014B2BFA38B3CA7U,  // [13] dec:  -5.17455916917166459E+00; hex:  -0X1.4B2BFA38B3CA70P+2
    0x3FF7E50A66AAB64AU,  // [14] dec:   1.49341812233196203E+00; hex:   0X1.7E50A66AAB64A0P+0
    0xBFD30189DD269CC9U   // [15] dec:  -2.96968904464347150E-01; hex:  -0X1.30189DD269CC90P-2
  };

// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 19 (20 coefficients in numerator / denominator);
// -- Suppression in stop band 100.0000 dB;
// -- Max. ripple in pass band 1.8000 dB;
// -- Cutoff frequency: 0.499 ([0..1] norm.)
// -- Transition width 0.002131305 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[20]):
static const uint64_t IIR_LOEL_TYPE1_B[] =              // 20 coefficients
  {
    0x3F6161697B0D5367U,  // [ 0] dec:   2.12164498990790066E-03; hex:   0X1.161697B0D53670P-9
    0x3F825101270482CAU,  // [ 1] dec:   8.94356632540062660E-03; hex:   0X1.25101270482CA0P-7
    0x3FA10E921FEB7E68U,  // [ 2] dec:   3.33142913784712502E-02; hex:   0X1.10E921FEB7E680P-5
    0x3FB5A04BFD8427A4U,  // [ 3] dec:   8.44771856247051312E-02; hex:   0X1.5A04BFD8427A40P-4
    0x3FC7EB1E3AE88D81U,  // [ 4] dec:   1.86862734569427175E-01; hex:   0X1.7EB1E3AE88D810P-3
    0x3FD5C96AEA4A7E7DU,  // [ 5] dec:   3.40418556976125164E-01; hex:   0X1.5C96AEA4A7E7D0P-2
    0x3FE18EDD91A0FC61U,  // [ 6] dec:   5.48689636641835787E-01; hex:   0X1.18EDD91A0FC610P-1
    0x3FE8A8BF47378D02U,  // [ 7] dec:   7.70599021049207744E-01; hex:   0X1.8A8BF47378D020P-1
    0x3FEEF082B98F2637U,  // [ 8] dec:   9.66859209461467084E-01; hex:   0X1.EF082B98F26370P-1
    0x3FF145DA25A5D794U,  // [ 9] dec:   1.07955374437503782E+00; hex:   0X1.145DA25A5D7940P+0
    0x3FF145DA25A5D794U,  // [10] dec:   1.07955374437503782E+00; hex:   0X1.145DA25A5D7940P+0
    0x3FEEF082B98F2637U,  // [11] dec:   9.66859209461467084E-01; hex:   0X1.EF082B98F26370P-1
    0x3FE8A8BF47378D02U,  // [12] dec:   7.70599021049207744E-01; hex:   0X1.8A8BF47378D020P-1
    0x3FE18EDD91A0FC61U,  // [13] dec:   5.48689636641835787E-01; hex:   0X1.18EDD91A0FC610P-1
    0x3FD5C96AEA4A7E7DU,  // [14] dec:   3.40418556976125164E-01; hex:   0X1.5C96AEA4A7E7D0P-2
    0x3FC7EB1E3AE88D81U,  // [15] dec:   1.86862734569427175E-01; hex:   0X1.7EB1E3AE88D810P-3
    0x3FB5A04BFD8427A4U,  // [16] dec:   8.44771856247051312E-02; hex:   0X1.5A04BFD8427A40P-4
    0x3FA10E921FEB7E68U,  // [17] dec:   3.33142913784712502E-02; hex:   0X1.10E921FEB7E680P-5
    0x3F825101270482CAU,  // [18] dec:   8.94356632540062660E-03; hex:   0X1.25101270482CA0P-7
    0x3F6161697B0D5367U   // [19] dec:   2.12164498990790066E-03; hex:   0X1.161697B0D53670P-9
  };
// Denominator coefficients (A[20]):
static const uint64_t IIR_LOEL_TYPE1_A[] =              // 20 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:   1.00000000000000000E+00; hex:   0X1.00000000000000P+0
    0xC00BE3111EBBDBBBU,  // [ 1] dec:  -3.48587249766157248E+00; hex:  -0X1.BE3111EBBDBBB0P+1
    0x4029CB565D718AEBU,  // [ 2] dec:   1.28971432877637735E+01; hex:   0X1.9CB565D718AEB0P+3
    0xC03DAD9F735F09F2U,  // [ 3] dec:  -2.96782142741230430E+01; hex:  -0X1.DAD9F735F09F20P+4
    0x404FED34E24987E7U,  // [ 4] dec:   6.38531763896024174E+01; hex:   0X1.FED34E24987E70P+5
    0xC05B3C744FA74ED8U,  // [ 5] dec:  -1.08944599069010451E+02; hex:  -0X1.B3C744FA74ED80P+6
    0x406532CB1673ABEDU,  // [ 6] dec:   1.69587290979310097E+02; hex:   0X1.532CB1673ABED0P+7
    0xC06C4113297FDCCFU,  // [ 7] dec:  -2.26033589124423514E+02; hex:  -0X1.C4113297FDCCF0P+7
    0x40711247F9140D45U,  // [ 8] dec:   2.73142571523978688E+02; hex:   0X1.11247F9140D450P+8
    0xC0723120723C637DU,  // [ 9] dec:  -2.91070421443837233E+02; hex:  -0X1.23120723C637D0P+8
    0x40717F3224575510U,  // [10] dec:   2.79949741688863469E+02; hex:   0X1.17F32245755100P+8
    0xC06DF42AD0229892U,  // [11] dec:  -2.39630226199693936E+02; hex:  -0X1.DF42AD02298920P+7
    0x4066EFE895AEBB8BU,  // [12] dec:   1.83497141686701383E+02; hex:   0X1.6EFE895AEBB8B0P+7
    0xC05F2616AB930265U,  // [13] dec:  -1.24595133679927656E+02; hex:  -0X1.F2616AB9302650P+6
    0x40528D2FC0B6F1DCU,  // [14] dec:   7.42060395990915254E+01; hex:   0X1.28D2FC0B6F1DC0P+6
    0xC043456E18C5A359U,  // [15] dec:  -3.85424223866491005E+01; hex:  -0X1.3456E18C5A3590P+5
    0x4030BC44890D868BU,  // [16] dec:   1.67354207666417487E+01; hex:   0X1.0BC44890D868B0P+4
    0xC01871184110BB14U,  // [17] dec:  -6.11044408478371182E+00; hex:  -0X1.871184110BB140P+2
    0x3FF968D61AD55638U,  // [18] dec:   1.58809481126571761E+00; hex:   0X1.968D61AD556380P+0
    0xBFD49BF4B3494DA4U   // [19] dec:  -3.22018790325467430E-01; hex:  -0X1.49BF4B3494DA40P-2
  };

// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 18 (19 coefficients in numerator / denominator);
// -- Suppression in stop band 90.0000 dB;
// -- Max. ripple in pass band 2.0000 dB;
// -- Cutoff frequency: 0.499 ([0..1] norm.)
// -- Transition width 0.0015685821 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[19]):
static const uint64_t IIR_LOEL_TYPE2_B[] =              // 19 coefficients
  {
    0x3F6E9A7EF6B1BFC5U,  // [ 0] dec:   3.73577878558959070E-03; hex:   0X1.E9A7EF6B1BFC50P-9
    0x3F8D2E91CD1EC78FU,  // [ 1] dec:   1.42489805910803995E-02; hex:   0X1.D2E91CD1EC78F0P-7
    0x3FAA79F8E2F29B07U,  // [ 2] dec:   5.17118241344203741E-02; hex:   0X1.A79F8E2F29B070P-5
    0x3FBF96D7550C1FA8U,  // [ 3] dec:   1.23395403159632822E-01; hex:   0X1.F96D7550C1FA80P-4
    0x3FD0D878B781A465U,  // [ 4] dec:   2.63212374883158795E-01; hex:   0X1.0D878B781A4650P-2
    0x3FDD287406E3950CU,  // [ 5] dec:   4.55594069221050502E-01; hex:   0X1.D287406E3950C0P-2
    0x3FE688A02DDFD48CU,  // [ 6] dec:   7.04177941892923709E-01; hex:   0X1.688A02DDFD48C0P-1
    0x3FEE12DA8CAC1E6BU,  // [ 7] dec:   9.39801478148138414E-01; hex:   0X1.E12DA8CAC1E6B0P-1
    0x3FF1FF5095FCB135U,  // [ 8] dec:   1.12483271206572266E+00; hex:   0X1.1FF5095FCB1350P+0
    0x3FF2FCC12CA77F3CU,  // [ 9] dec:   1.18670766299324182E+00; hex:   0X1.2FCC12CA77F3C0P+0
    0x3FF1FF5095FCB135U,  // [10] dec:   1.12483271206572266E+00; hex:   0X1.1FF5095FCB1350P+0
    0x3FEE12DA8CAC1E6BU,  // [11] dec:   9.39801478148138414E-01; hex:   0X1.E12DA8CAC1E6B0P-1
    0x3FE688A02DDFD48CU,  // [12] dec:   7.04177941892923709E-01; hex:   0X1.688A02DDFD48C0P-1
    0x3FDD287406E3950CU,  // [13] dec:   4.55594069221050502E-01; hex:   0X1.D287406E3950C0P-2
    0x3FD0D878B781A465U,  // [14] dec:   2.63212374883158795E-01; hex:   0X1.0D878B781A4650P-2
    0x3FBF96D7550C1FA8U,  // [15] dec:   1.23395403159632822E-01; hex:   0X1.F96D7550C1FA80P-4
    0x3FAA79F8E2F29B07U,  // [16] dec:   5.17118241344203741E-02; hex:   0X1.A79F8E2F29B070P-5
    0x3F8D2E91CD1EC78FU,  // [17] dec:   1.42489805910803995E-02; hex:   0X1.D2E91CD1EC78F0P-7
    0x3F6E9A7EF6B1BFC5U   // [18] dec:   3.73577878558959070E-03; hex:   0X1.E9A7EF6B1BFC50P-9
  };
// Denominator coefficients (A[19]):
static const uint64_t IIR_LOEL_TYPE2_A[] =              // 19 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:   1.00000000000000000E+00; hex:   0X1.00000000000000P+0
    0xC0092AC401383A97U,  // [ 1] dec:  -3.14588166191908725E+00; hex:  -0X1.92AC401383A970P+1
    0x402706943572E6D8U,  // [ 2] dec:   1.15128494932900338E+01; hex:   0X1.706943572E6D80P+3
    0xC038C950A3E9F4D6U,  // [ 3] dec:  -2.47863867231543153E+01; hex:  -0X1.8C950A3E9F4D60P+4
    0x4049F5E6E469F532U,  // [ 4] dec:   5.19211087720272104E+01; hex:   0X1.9F5E6E469F5320P+5
    0xC054F78F96DD3086U,  // [ 5] dec:  -8.38681389961294315E+01; hex:  -0X1.4F78F96DD30860P+6
    0x405F784A718E717BU,  // [ 6] dec:   1.25879543675522584E+02; hex:   0X1.F784A718E717B0P+6
    0xC063E5A30D385B20U,  // [ 7] dec:  -1.59176153764791707E+02; hex:  -0X1.3E5A30D385B200P+7
    0x4066FD0682B4A986U,  // [ 8] dec:   1.83907044747215139E+02; hex:   0X1.6FD0682B4A9860P+7
    0xC06725D13A96869BU,  // [ 9] dec:  -1.85181790632243832E+02; hex:  -0X1.725D13A96869B0P+7
    0x4065149F4F67003CU,  // [10] dec:   1.68644447041677154E+02; hex:   0X1.5149F4F67003C0P+7
    0xC060DF1ECDAD31E8U,  // [11] dec:  -1.34972510183593158E+02; hex:  -0X1.0DF1ECDAD31E80P+7
    0x4058250DE3188732U,  // [12] dec:   9.65789726008922855E+01; hex:   0X1.8250DE31887320P+6
    0xC04DFF728CADEDE5U,  // [13] dec:  -5.99956832741989174E+01; hex:  -0X1.DFF728CADEDE50P+5
    0x40405D935F702666U,  // [14] dec:   3.27310599610907929E+01; hex:   0X1.05D935F7026660P+5
    0xC02D9533B6F8B039U,  // [15] dec:  -1.47914101770949049E+01; hex:  -0X1.D9533B6F8B0390P+3
    0x4016CCDD5114D015U,  // [16] dec:   5.70006300630122542E+00; hex:   0X1.6CCDD5114D0150P+2
    0xBFF88F38CE481232U,  // [17] dec:  -1.53496628359529241E+00; hex:  -0X1.88F38CE4812320P+0
    0x3FD5B6E904808550U   // [18] dec:   3.39288954159276734E-01; hex:   0X1.5B6E9048085500P-2
  };

// !!THE UGLY FILTER -- NOT FOR CONVENTIONAL USE -- ONLY FOR EXPERIMENTS --
// -- THE GUY IS ABOUT GENERATION NEAR CUTOFF FREUENCY!!
// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 19 (20 coefficients in numerator / denominator);
// -- Suppression in stop band 96.0000 dB;
// -- Max. ripple in pass band 2.0000 dB;
// -- Cutoff frequency: 0.4982 ([0..1] norm.)
// -- Transition width 0.0015899102 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[20]):
static const uint64_t IIR_LOEL_TYPE3_B[] =              // 20 coefficients
  {
    0x3F6576F5632D9DDBU,  // [ 0] dec:   2.62020041684583654E-03; hex:   0X1.576F5632D9DDB0P-9
    0x3F856D2EC232C5C5U,  // [ 1] dec:   1.04621556295992988E-02; hex:   0X1.56D2EC232C5C50P-7
    0x3FA400328D15A2EEU,  // [ 2] dec:   3.90640065405188780E-02; hex:   0X1.400328D15A2EE0P-5
    0x3FB8D24D69D73A75U,  // [ 3] dec:   9.69589599037393307E-02; hex:   0X1.8D24D69D73A750P-4
    0x3FCB65B7E3A5D888U,  // [ 4] dec:   2.14041696697396810E-01; hex:   0X1.B65B7E3A5D8880P-3
    0x3FD8B2ED62D8AE54U,  // [ 5] dec:   3.85920855073640157E-01; hex:   0X1.8B2ED62D8AE540P-2
    0x3FE3DC44959556EEU,  // [ 6] dec:   6.20638172297473423E-01; hex:   0X1.3DC44959556EE0P-1
    0x3FEBC12160D87581U,  // [ 7] dec:   8.67325486327601536E-01; hex:   0X1.BC12160D875810P-1
    0x3FF1639B99290A7CU,  // [ 8] dec:   1.08681831196068313E+00; hex:   0X1.1639B99290A7C0P+0
    0x3FF3630A01EB20D7U,  // [ 9] dec:   1.21167946576502117E+00; hex:   0X1.3630A01EB20D70P+0
    0x3FF3630A01EB20D7U,  // [10] dec:   1.21167946576502117E+00; hex:   0X1.3630A01EB20D70P+0
    0x3FF1639B99290A7CU,  // [11] dec:   1.08681831196068313E+00; hex:   0X1.1639B99290A7C0P+0
    0x3FEBC12160D87581U,  // [12] dec:   8.67325486327601536E-01; hex:   0X1.BC12160D875810P-1
    0x3FE3DC44959556EEU,  // [13] dec:   6.20638172297473423E-01; hex:   0X1.3DC44959556EE0P-1
    0x3FD8B2ED62D8AE54U,  // [14] dec:   3.85920855073640157E-01; hex:   0X1.8B2ED62D8AE540P-2
    0x3FCB65B7E3A5D888U,  // [15] dec:   2.14041696697396810E-01; hex:   0X1.B65B7E3A5D8880P-3
    0x3FB8D24D69D73A75U,  // [16] dec:   9.69589599037393307E-02; hex:   0X1.8D24D69D73A750P-4
    0x3FA400328D15A2EEU,  // [17] dec:   3.90640065405188780E-02; hex:   0X1.400328D15A2EE0P-5
    0x3F856D2EC232C5C5U,  // [18] dec:   1.04621556295992988E-02; hex:   0X1.56D2EC232C5C50P-7
    0x3F6576F5632D9DDBU   // [19] dec:   2.62020041684583654E-03; hex:   0X1.576F5632D9DDB0P-9
  };
// Denominator coefficients (A[20]):
static const uint64_t IIR_LOEL_TYPE3_A[] =              // 20 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:   1.00000000000000000E+00; hex:   0X1.00000000000000P+0
    0xC00B41B2DE94FB4FU,  // [ 1] dec:  -3.40707944767147053E+00; hex:  -0X1.B41B2DE94FB4F0P+1
    0x402970A0EA172389U,  // [ 2] dec:   1.27199776795621506E+01; hex:   0X1.970A0EA1723890P+3
    0xC03CFED84AB0DBBAU,  // [ 3] dec:  -2.89954878503592468E+01; hex:  -0X1.CFED84AB0DBBA0P+4
    0x404F590317F3B2D8U,  // [ 4] dec:   6.26954069080290424E+01; hex:   0X1.F590317F3B2D80P+5
    0xC05AA35640A0CE40U,  // [ 5] dec:  -1.06552139431988508E+02; hex:  -0X1.AA35640A0CE400P+6
    0x4064CDC8BD4AFCECU,  // [ 6] dec:   1.66430754324398890E+02; hex:   0X1.4CDC8BD4AFCEC0P+7
    0xC06BB310D90027C3U,  // [ 7] dec:  -2.21595806598952635E+02; hex:  -0X1.BB310D90027C30P+7
    0x4070C8F6C4CDE91FU,  // [ 8] dec:   2.68560246280992885E+02; hex:   0X1.0C8F6C4CDE91F0P+8
    0xC071E67A4835943CU,  // [ 9] dec:  -2.86404854020398261E+02; hex:  -0X1.1E67A4835943C0P+8
    0x407144517F3D65BAU,  // [10] dec:   2.76269896735986208E+02; hex:   0X1.144517F3D65BA0P+8
    0xC06D9FEC74522EDFU,  // [11] dec:  -2.36997614059938286E+02; hex:  -0X1.D9FEC74522EDF0P+7
    0x4066C2447072B042U,  // [12] dec:   1.82070854400635710E+02; hex:   0X1.6C2447072B0420P+7
    0xC05F058A09B237B5U,  // [13] dec:  -1.24086550163307791E+02; hex:  -0X1.F058A09B237B50P+6
    0x40528B6CE7AB7D58U,  // [14] dec:   7.41785220312789306E+01; hex:   0X1.28B6CE7AB7D580P+6
    0xC043617A89680E04U,  // [15] dec:  -3.87615520246581866E+01; hex:  -0X1.3617A89680E040P+5
    0x4030E63ADAFAA32CU,  // [16] dec:   1.68993355619342509E+01; hex:   0X1.0E63ADAFAA32C0P+4
    0xC018F5717FC55DA9U,  // [17] dec:  -6.23969077722669230E+00; hex:  -0X1.8F5717FC55DA90P+2
    0x3FFA06EE9694B32DU,  // [18] dec:   1.62669237919471787E+00; hex:   0X1.A06EE9694B32D0P+0
    0xBFD5C02814FC1464U   // [19] dec:  -3.39853306286675982E-01; hex:  -0X1.5C02814FC14640P-2
  };

// !!THE UGLY FILTER -- NOT FOR CONVENTIONAL USE -- ONLY FOR EXPERIMENTS --
// -- THE GUY IS ABOUT GENERATION NEAR CUTOFF FREUENCY!!
// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 20 (21 coefficients in numerator / denominator);
// -- Suppression in stop band 100.0000 dB;
// -- Max. ripple in pass band 2.0000 dB;
// -- Cutoff frequency: 0.4982 ([0..1] norm.)
// -- Transition width 0.001414773 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[21]):
static const uint64_t IIR_LOEL_TYPE4_B[] =              // 21 coefficients
  {
    0x3F6105CB6F968100U,  // [ 0] dec:   2.07795842716518298E-03; hex:   0X1.105CB6F9681000P-9
    0x3F8195555C407D81U,  // [ 1] dec:   8.58561218052389559E-03; hex:   0X1.195555C407D810P-7
    0x3FA0E59EF799A4B8U,  // [ 2] dec:   3.30018689390469411E-02; hex:   0X1.0E59EF799A4B80P-5
    0x3FB5AE596B0097CBU,  // [ 3] dec:   8.46916090236781577E-02; hex:   0X1.5AE596B0097CB0P-4
    0x3FC8BDB5559626ECU,  // [ 4] dec:   1.93289439001368080E-01; hex:   0X1.8BDB5559626EC0P-3
    0x3FD71EFCA4C56031U,  // [ 5] dec:   3.61266289624384618E-01; hex:   0X1.71EFCA4C560310P-2
    0x3FE350C32D4AD5F3U,  // [ 6] dec:   6.03608692609382991E-01; hex:   0X1.350C32D4AD5F30P-1
    0x3FEC1A5B8F8C1537U,  // [ 7] dec:   8.78217487683889853E-01; hex:   0X1.C1A5B8F8C15370P-1
    0x3FF26A21675B9141U,  // [ 8] dec:   1.15091076253982316E+00; hex:   0X1.26A21675B91410P+0
    0x3FF58094A7AF0084U,  // [ 9] dec:   1.34389176846892244E+00; hex:   0X1.58094A7AF00840P+0
    0x3FF6B598D2C7D278U,  // [10] dec:   1.41933519683985132E+00; hex:   0X1.6B598D2C7D2780P+0
    0x3FF58094A7AF0084U,  // [11] dec:   1.34389176846892244E+00; hex:   0X1.58094A7AF00840P+0
    0x3FF26A21675B9141U,  // [12] dec:   1.15091076253982316E+00; hex:   0X1.26A21675B91410P+0
    0x3FEC1A5B8F8C1537U,  // [13] dec:   8.78217487683889853E-01; hex:   0X1.C1A5B8F8C15370P-1
    0x3FE350C32D4AD5F3U,  // [14] dec:   6.03608692609382991E-01; hex:   0X1.350C32D4AD5F30P-1
    0x3FD71EFCA4C56031U,  // [15] dec:   3.61266289624384618E-01; hex:   0X1.71EFCA4C560310P-2
    0x3FC8BDB5559626ECU,  // [16] dec:   1.93289439001368080E-01; hex:   0X1.8BDB5559626EC0P-3
    0x3FB5AE596B0097CBU,  // [17] dec:   8.46916090236781577E-02; hex:   0X1.5AE596B0097CB0P-4
    0x3FA0E59EF799A4B8U,  // [18] dec:   3.30018689390469411E-02; hex:   0X1.0E59EF799A4B80P-5
    0x3F8195555C407D81U,  // [19] dec:   8.58561218052389559E-03; hex:   0X1.195555C407D810P-7
    0x3F6105CB6F968100U   // [20] dec:   2.07795842716518298E-03; hex:   0X1.105CB6F9681000P-9
  };
// Denominator coefficients (A[21]):
static const uint64_t IIR_LOEL_TYPE4_A[] =              // 21 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:   1.00000000000000000E+00; hex:   0X1.00000000000000P+0
    0xC00C7D831D05F2EFU,  // [ 1] dec:  -3.56128523516087325E+00; hex:  -0X1.C7D831D05F2EF0P+1
    0x402B53239E2CB68FU,  // [ 2] dec:   1.36623811177808232E+01; hex:   0X1.B53239E2CB68F0P+3
    0xC0403152EF453A98U,  // [ 3] dec:  -3.23853434646636629E+01; hex:  -0X1.03152EF453A980P+5
    0x40521900DD2BA8B9U,  // [ 4] dec:   7.23906777311666616E+01; hex:   0X1.21900DD2BA8B90P+6
    0xC0600131FE8CEFA9U,  // [ 5] dec:  -1.28037352824464762E+02; hex:  -0X1.00131FE8CEFA90P+7
    0x4069FD3AF984B0E9U,  // [ 6] dec:   2.07913449057733743E+02; hex:   0X1.9FD3AF984B0E90P+7
    0xC07212F6429C4DEAU,  // [ 7] dec:  -2.89185122118533968E+02; hex:  -0X1.212F6429C4DEA0P+8
    0x4076ED287933DBDEU,  // [ 8] dec:   3.66822381212781579E+02; hex:   0X1.6ED287933DBDE0P+8
    0xC079B403EF32D23EU,  // [ 9] dec:  -4.11250960539360563E+02; hex:  -0X1.9B403EF32D23E0P+8
    0x407A30F3C552AAB6U,  // [10] dec:   4.19059514353673308E+02; hex:   0X1.A30F3C552AAB60P+8
    0xC077D860A199AAC0U,  // [11] dec:  -3.81523591614019097E+02; hex:  -0X1.7D860A199AAC00P+8
    0x4073A0AD5911D751U,  // [12] dec:   3.14042321271602361E+02; hex:   0X1.3A0AD5911D7510P+8
    0xC06CCD27D9C0C89CU,  // [13] dec:  -2.30411114574938324E+02; hex:  -0X1.CCD27D9C0C89C0P+7
    0x4062E942A9414612U,  // [14] dec:   1.51289387347686500E+02; hex:   0X1.2E942A94146120P+7
    0xC055C1A407B98E99U,  // [15] dec:  -8.70256366073684973E+01; hex:  -0X1.5C1A407B98E990P+6
    0x4045FB3E1842F958U,  // [16] dec:   4.39628324820538978E+01; hex:   0X1.5FB3E1842F9580P+5
    0xC03289B639476CC9U,  // [17] dec:  -1.85379367637040424E+01; hex:  -0X1.289B639476CC90P+4
    0x401A888D613D4731U,  // [18] dec:   6.63335182129394330E+00; hex:   0X1.A888D613D47310P+2
    0xBFFADD011B196264U,  // [19] dec:  -1.67895613275154520E+00; hex:  -0X1.ADD011B1962640P+0
    0x3FD5C0724C396084U   // [20] dec:   3.39871000707269610E-01; hex:   0X1.5C0724C3960840P-2
  };

// !!THE UGLY FILTER -- NOT FOR CONVENTIONAL USE -- ONLY FOR EXPERIMENTS --
// -- THE GUY IS ABOUT GENERATION NEAR CUTOFF FREUENCY!!
// -- Type: LPF; Approximation: ELLIP;
// -- Filter order: 20 (21 coefficients in numerator / denominator);
// -- Suppression in stop band 100.0000 dB;
// -- Max. ripple in pass band 2.0000 dB;
// -- Cutoff frequency: 0.4985 ([0..1] norm.)
// -- Transition width 0.001414773 (??unsure-R&C) ([0..1] norm.)
// Numerator coefficients (B[21]):
static const uint64_t IIR_LOEL_TYPE5_B[] =              // 21 coefficients
  {
    0x3F61159F2893ADD4U,  // [ 0] dec:   2.08550534863658800E-03; hex:   0X1.1159F2893ADD40P-9
    0x3F81B78E32C1EFB3U,  // [ 1] dec:   8.65088550948898104E-03; hex:   0X1.1B78E32C1EFB30P-7
    0x3FA106C5A6FC4FBCU,  // [ 2] dec:   3.32547918643792684E-02; hex:   0X1.106C5A6FC4FBC0P-5
    0x3FB5E21841EE9B6AU,  // [ 3] dec:   8.54811821906033276E-02; hex:   0X1.5E21841EE9B6A0P-4
    0x3FC8FABD412C5BC3U,  // [ 4] dec:   1.95151955435646313E-01; hex:   0X1.8FABD412C5BC30P-3
    0x3FD75D0E0193E240U,  // [ 5] dec:   3.65054608860678087E-01; hex:   0X1.75D0E0193E2400P-2
    0x3FE385FB01C7E6B8U,  // [ 6] dec:   6.10105041006327120E-01; hex:   0X1.385FB01C7E6B80P-1
    0x3FEC6B03D788367EU,  // [ 7] dec:   8.88063355408760691E-01; hex:   0X1.C6B03D788367E0P-1
    0x3FF29FB5A8D5D4EDU,  // [ 8] dec:   1.16399160338670105E+00; hex:   0X1.29FB5A8D5D4ED0P+0
    0x3FF5C036DE9A75CBU,  // [ 9] dec:   1.35942732767522290E+00; hex:   0X1.5C036DE9A75CB0P+0
    0x3FF6F8C8E4E7A8C1U,  // [10] dec:   1.43573846260055427E+00; hex:   0X1.6F8C8E4E7A8C10P+0
    0x3FF5C036DE9A75CBU,  // [11] dec:   1.35942732767522290E+00; hex:   0X1.5C036DE9A75CB0P+0
    0x3FF29FB5A8D5D4EDU,  // [12] dec:   1.16399160338670105E+00; hex:   0X1.29FB5A8D5D4ED0P+0
    0x3FEC6B03D788367EU,  // [13] dec:   8.88063355408760691E-01; hex:   0X1.C6B03D788367E0P-1
    0x3FE385FB01C7E6B8U,  // [14] dec:   6.10105041006327120E-01; hex:   0X1.385FB01C7E6B80P-1
    0x3FD75D0E0193E240U,  // [15] dec:   3.65054608860678087E-01; hex:   0X1.75D0E0193E2400P-2
    0x3FC8FABD412C5BC3U,  // [16] dec:   1.95151955435646313E-01; hex:   0X1.8FABD412C5BC30P-3
    0x3FB5E21841EE9B6AU,  // [17] dec:   8.54811821906033276E-02; hex:   0X1.5E21841EE9B6A0P-4
    0x3FA106C5A6FC4FBCU,  // [18] dec:   3.32547918643792684E-02; hex:   0X1.106C5A6FC4FBC0P-5
    0x3F81B78E32C1EFB3U,  // [19] dec:   8.65088550948898104E-03; hex:   0X1.1B78E32C1EFB30P-7
    0x3F61159F2893ADD4U   // [20] dec:   2.08550534863658800E-03; hex:   0X1.1159F2893ADD40P-9
  };
// Denominator coefficients (A[21]):
static const uint64_t IIR_LOEL_TYPE5_A[] =              // 21 coefficients
  {
    0x3FF0000000000000U,  // [ 0] dec:   1.00000000000000000E+00; hex:   0X1.00000000000000P+0
    0xC00C5C13562F35ABU,  // [ 1] dec:  -3.54495875674793615E+00; hex:  -0X1.C5C13562F35AB0P+1
    0x402B372B7A90A8CEU,  // [ 2] dec:   1.36077535916887449E+01; hex:   0X1.B372B7A90A8CE0P+3
    0xC0401806B0E5C4C9U,  // [ 3] dec:  -3.21877041932980958E+01; hex:  -0X1.01806B0E5C4C90P+5
    0x4051FCF1E57864C1U,  // [ 4] dec:   7.19522641826361138E+01; hex:   0X1.1FCF1E57864C10P+6
    0xC05FC7BF88AFB201U,  // [ 5] dec:  -1.27121065303399533E+02; hex:  -0X1.FC7BF88AFB2010P+6
    0x4069CD10C8332467U,  // [ 6] dec:   2.06408298587691405E+02; hex:   0X1.9CD10C83324670P+7
    0xC071EEC5AC424356U,  // [ 7] dec:  -2.86923259981956448E+02; hex:  -0X1.1EEC5AC4243560P+8
    0x4076BEEB20E0DB5EU,  // [ 8] dec:   3.63932404402110365E+02; hex:   0X1.6BEEB20E0DB5E0P+8
    0xC0797E75E4624E80U,  // [ 9] dec:  -4.07903782257089915E+02; hex:  -0X1.97E75E4624E800P+8
    0x4079FAA628BE94BEU,  // [10] dec:   4.15665566200692297E+02; hex:   0X1.9FAA628BE94BE0P+8
    0xC077A6C97DFBD35AU,  // [11] dec:  -3.78424192413037986E+02; hex:  -0X1.7A6C97DFBD35A0P+8
    0x407378C685DF0FE2U,  // [12] dec:   3.11548467513404944E+02; hex:   0X1.378C685DF0FE20P+8
    0xC06C93E57AB73D9AU,  // [13] dec:  -2.28621762617008073E+02; hex:  -0X1.C93E57AB73D9A0P+7
    0x4062C57E50CDAAB7U,  // [14] dec:   1.50171669389432026E+02; hex:   0X1.2C57E50CDAAB70P+7
    0xC0559A82C51394C9U,  // [15] dec:  -8.64142315570089892E+01; hex:  -0X1.59A82C51394C90P+6
    0x4045D786C4D92F43U,  // [16] dec:   4.36838003216239699E+01; hex:   0X1.5D786C4D92F430P+5
    0xC0326E1DBA59F927U,  // [17] dec:  -1.84301411122952707E+01; hex:  -0X1.26E1DBA59F9270P+4
    0x401A69C73049B9A7U,  // [18] dec:   6.60329890680296838E+00; hex:   0X1.A69C73049B9A70P+2
    0xBFFAC1D49C17AAC7U,  // [19] dec:  -1.67232190106976630E+00; hex:  -0X1.AC1D49C17AAC70P+0
    0x3FD5BCD46E1338A1U   // [20] dec:   3.39650256629179081E-01; hex:   0X1.5BCD46E1338A10P-2
  };

#endif                  // def FP_MIXED

// the static table of filters
const RP_IIR_FILTER_DESCR iir_hb_lpf_const_filters[] =
{
 {
  RP_IIR_LPF | RP_IIR_ELLIP,
  15,                           // order
  100.0000,                     // suppression
  1.5000,                       // ripple
  0.495,                        // left cutoff
  0,                            // right cutoff
  0.0099170047,                 // (??unsure-R&C) transition width
  IIR_LOEL_TYPE0_B,
  IIR_LOEL_TYPE0_A
 }

 ,
 {
  RP_IIR_LPF | RP_IIR_ELLIP,
  19,                           // order
  100.0000,                     // suppression
  1.8000,                       // ripple
  0.499,                        // left cutoff
  0,                            // right cutoff
  0.002131305,                  // (??unsure-R&C) transition width
  IIR_LOEL_TYPE1_B,
  IIR_LOEL_TYPE1_A
 }

 ,
 {
  RP_IIR_LPF | RP_IIR_ELLIP,
  18,                           // order
  90.0000,                      // suppression
  2.0000,                       // ripple
  0.499,                        // left cutoff
  0,                            // right cutoff
  0.0015685821,                 // (??unsure-R&C) transition width
  IIR_LOEL_TYPE2_B,
  IIR_LOEL_TYPE2_A
 }

 ,
 {
  RP_IIR_LPF | RP_IIR_ELLIP,
  19,                           // order
  96.0000,                      // suppression
  2.0000,                       // ripple
  0.4982,                       // left cutoff
  0,                            // right cutoff
  0.0015899102,                 // (??unsure-R&C) transition width
  IIR_LOEL_TYPE3_B,
  IIR_LOEL_TYPE3_A
 }

 ,
 {
  RP_IIR_LPF | RP_IIR_ELLIP,
  20,                           // order
  100.0000,                     // suppression
  2.0000,                       // ripple
  0.4982,                       // left cutoff
  0,                            // right cutoff
  0.001414773,                  // (??unsure-R&C) transition width
  IIR_LOEL_TYPE4_B,
  IIR_LOEL_TYPE4_A
 }

 ,
 {
  RP_IIR_LPF | RP_IIR_ELLIP,
  20,                           // order
  100.0000,                     // suppression
  2.0000,                       // ripple
  0.4985,                       // left cutoff
  0,                            // right cutoff
  0.001414773,                  // (??unsure-R&C) transition width
  IIR_LOEL_TYPE5_B,
  IIR_LOEL_TYPE5_A
 }

// [...to be continued...]
};


/* filter computation implementation
 * ------ ----------- --------------
 */
/* create the filter by IIR_COEFF
*/
IIR_RAT_POLY *iir_rp_create(const RP_IIR_FILTER_DESCR *fdescr, const IIR_COMP_CONFIG *comp_cfg)
{
 IIR_RAT_POLY *filter = cmalloc(sizeof(IIR_RAT_POLY));
 double a0;
 int i;
 union
 {
  double d;
  uint64_t u;
 } du;                  // we under x86 and only x86

#define U2D(U_)     (du.u = (U_), du.d)

 filter -> pc = filter -> pd = filter -> pz = NULL;
 filter -> nord = fdescr -> order;

 // we suppose, that the new operator always successful
 filter -> pc = cmalloc(filter -> nord * sizeof(double));
 filter -> pd = cmalloc(filter -> nord * sizeof(double));
 filter -> pz = cmalloc(filter -> nord * sizeof(double));

 a0 = U2D(fdescr -> vec_a[0]);
 filter -> d0 = U2D(fdescr -> vec_b[0]) / a0;
 for(i = 0; i < filter -> nord; ++i)
 {
  int j = i + 1;
  filter -> pc[i] = -U2D(fdescr -> vec_a[j]) / a0;
  filter -> pd[i] =  U2D(fdescr -> vec_b[j]) / a0;
 }

 iir_rp_setcfg(filter, comp_cfg);
 iir_rp_reset(filter);
 return filter;

#undef U2D
}

/* destroy the filter
*/
void iir_rp_destroy(IIR_RAT_POLY *filter)
{
 if(filter)
 {
  if(filter -> pz)
  {
   free(filter -> pz);
   filter -> pz = NULL;
  }
  if(filter -> pd)
  {
   free(filter -> pd);
   filter -> pd = NULL;
  }
  if(filter -> pc)
  {
   free(filter -> pc);
   filter -> pc = NULL;
  }

  free(filter);
  filter = NULL;                        // :))
 }
}

/* process one sample -- canonical form, min. computations, BUT NOT SO GOOD FOR ROUNDING ERRORS
*/
double iir_rp_process_baseline(double sample, IIR_RAT_POLY *filter, FP_EXCEPT_STATS *fes)
{
#define FES         (fes)

 double sum_i = sample;
 double sum_o = 0.0;
 int k = filter -> ix;
 int i;

 if(!fes -> is_enable)
 {                                              // == WITHOUT FP CHECKS ==
  for(i = 0; i < filter -> nord; ++i)
  {
   if(0 == k)
    k = filter -> nord;
   --k;

   sum_i += filter -> pz[k] * filter -> pc[i];
   sum_o += filter -> pz[k] * filter -> pd[i];
  }

  if(filter -> is_subnorm_reject && (fabs(sum_i) < filter -> is_subnorm_reject))
  {
   sum_i = 0.0;
   ++(filter -> subnorm_cnt);
  }

  filter -> pz[filter -> ix] = sum_i;
  if(++(filter -> ix) >= filter -> nord)        // m_ix = (++m_ix) % m_nord; -- it's BAD for iNTEL
   filter -> ix = 0;

  return sum_i * filter -> d0 + sum_o;
 }
 else
 {                                              // == WITH FP CHECKS ==
  for(i = 0; i < filter -> nord; ++i)
  {
   if(0 == k)
    k = filter -> nord;
   --k;

   sum_i = FC(sum_i + FC(filter -> pz[k] * filter -> pc[i]));
   sum_o = FC(sum_o + FC(filter -> pz[k] * filter -> pd[i]));
  }

  if(filter -> is_subnorm_reject && (fabs(sum_i) < filter -> is_subnorm_reject))
  {
   sum_i = 0.0;
   ++(filter -> subnorm_cnt);
  }

  filter -> pz[filter -> ix] = sum_i;
  if(++(filter -> ix) >= filter -> nord)        // m_ix = (++m_ix) % m_nord; -- it's BAD for iNTEL
   filter -> ix = 0;

  return FC(FC(sum_i * filter -> d0) + sum_o);
 }

#undef FES
}


/* process one sample -- canonical form / Kahan summations
*/
/* the helpers to compute unstable sums
*/
/* Kahan Summation Formula (X[0] + X[1] + ... + X[N-1]):
 *      S = X[0];
 *      C = 0;
 *      for j = 1 to (N-1) {
 *          Y = X[j] - C
 *          T = S + Y;
 *          C = (T - S) - Y;
 *          S = T;
 *      }
 * ..and if we are brave enogh, we can do hope, that the compiler does not
 * "optimize" it to the "strait" summation..
 */

// summation descriptor -- all the fields as in pseudocode
struct kahan
{
 double S, C, Y, T;
};

// The Kahan summation primitives
// S = X[0]; C = 0;
static __inline void kahan_init(double X0, struct kahan *sum_kh)
{
 sum_kh -> S = X0;
 sum_kh -> C = 0.0;
}
// one step: Y = X[j] - C; Y = X[j] - C; C = (T - S) - Y; 
static __inline void kahan_step(double Xj, struct kahan *sum_kh)
{
 sum_kh -> Y =  Xj          - sum_kh -> C;
 sum_kh -> T =  sum_kh -> S + sum_kh -> Y;
 sum_kh -> C = (sum_kh -> T - sum_kh -> S) - sum_kh -> Y;
 sum_kh -> S =  sum_kh -> T;
}
// one step with floating exceptions checks
static __inline void kahan_step_fes(double Xj, struct kahan *sum_kh, FP_EXCEPT_STATS *fes)
{
#define FES         (fes)

 sum_kh -> Y =     FC(Xj          - sum_kh -> C);
 sum_kh -> T =     FC(sum_kh -> S + sum_kh -> Y);
 sum_kh -> C =  FC(FC(sum_kh -> T - sum_kh -> S) - sum_kh -> Y);
 sum_kh -> S =        sum_kh -> T;

#undef FES
}

// IIR process itself
double iir_rp_process_kahan(double sample, IIR_RAT_POLY *filter, FP_EXCEPT_STATS *fes)
{
#define FES         (fes)

 struct kahan sum_i, sum_o;
 double ti;
 int k = filter -> ix;
 int i;

 kahan_init(sample, &sum_i);

 if(!fes -> is_enable)
 {                                              // == WITHOUT FP CHECKS ==
  // actions for i = 0
  if(0 == k)
   k = filter -> nord;
  --k;

  ti = filter -> pz[k] * filter -> pc[0];
  kahan_step(ti, &sum_i);

  kahan_init(filter -> pz[k] * filter -> pd[0], &sum_o);
  kahan_step(ti              * filter -> d0,    &sum_o);

  // actions for i > 0
  for(i = 1; i < filter -> nord; ++i)
  {
   if(0 == k)
    k = filter -> nord;
   --k;

   ti = filter -> pz[k] * filter -> pc[i];
   kahan_step(ti, &sum_i);

   kahan_step(filter -> pz[k] * filter -> pd[i], &sum_o);
   kahan_step(ti              * filter -> d0,    &sum_o);
  }

  if(filter -> is_subnorm_reject && (fabs(sum_i.S) < filter -> is_subnorm_reject))
  {
   sum_i.S = 0.0;
   ++(filter -> subnorm_cnt);
  }

  filter -> pz[filter -> ix] = sum_i.S;
  if(++(filter -> ix) >= filter -> nord)        // m_ix = (++m_ix) % m_nord; -- it's BAD for iNTEL
   filter -> ix = 0;

  return sum_o.S;
 }
 else
 {                                              // == WITH FP CHECKS ==
  // actions for i = 0
  if(0 == k)
   k = filter -> nord;
  --k;

  ti = FC(filter -> pz[k] * filter -> pc[0]);
  kahan_step_fes(ti, &sum_i, fes);

  kahan_init    (FC(filter -> pz[k] * filter -> pd[0]), &sum_o);
  kahan_step_fes(FC(ti              * filter -> d0   ), &sum_o, fes);

  // actions for i > 0
  for(i = 1; i < filter -> nord; ++i)
  {
   if(0 == k)
    k = filter -> nord;
   --k;

   ti = FC(filter -> pz[k] * filter -> pc[i]);
   kahan_step_fes(ti, &sum_i, fes);

   kahan_step_fes(FC(filter -> pz[k] * filter -> pd[i]), &sum_o, fes);
   kahan_step_fes(FC(ti              * filter -> d0   ), &sum_o, fes);
  }

  if(filter -> is_subnorm_reject && (fabs(sum_i.S) < filter -> is_subnorm_reject))
  {
   sum_i.S = 0.0;
   ++(filter -> subnorm_cnt);
  }

  filter -> pz[filter -> ix] = sum_i.S;
  if(++(filter -> ix) >= filter -> nord)        // m_ix = (++m_ix) % m_nord; -- it's BAD for iNTEL
   filter -> ix = 0;

  return sum_o.S;
 }

#undef FES
}

/* reset the filter
*/
void iir_rp_reset(IIR_RAT_POLY *filter)
{
 int i;

 for(i = 0; i < filter -> nord; ++i)
  filter -> pz[i] = 0.0;

 filter -> ix = 0;

 iir_rp_reset_sncnt(filter);                    // mandatory here
}

/* change summation algorithm
*/
void iir_rp_setcfg(IIR_RAT_POLY *filter, const IIR_COMP_CONFIG *comp_cfg)
{
 filter -> subnorm_thr          = comp_cfg -> subnorm_thr;          // in God we trust..
 filter -> is_subnorm_reject    = comp_cfg -> is_subnorm_reject;
 filter -> process              = comp_cfg -> is_kahan?
    &iir_rp_process_kahan
    :
    &iir_rp_process_baseline;

 iir_rp_reset_sncnt(filter);                                        // "new world"
}

/* reset subnorm rejecttions counter
*/
void iir_rp_reset_sncnt(IIR_RAT_POLY *filter)
{
 filter -> subnorm_cnt = 0ULL;
}

/* get current subnorm rejecttions counter
*/
uint64_t iir_rp_get_sncnt(IIR_RAT_POLY *filter)
{
 return filter -> subnorm_cnt;
}

/* the end...
*/

